.LOGON localhost/dbc,dbc;

-- TCH tables are not recreated if they already exist

-- Check if T_SUIVI_RUN table exists in TCH database
SELECT * FROM dbc.tables WHERE tablename='T_SUIVI_RUN' AND databasename='TCH';

-- If the table exists, skip to the next table
.IF ACTIVITYCOUNT>0 THEN .GOTO LABEL_SKIP_CREATE_T_SUIVI_RUN;

-- Create T_SUIVI_RUN table
CREATE TABLE TCH.T_SUIVI_RUN (
    RUN_ID INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    RUN_STRT_DTTM TIMESTAMP(0) NOT NULL,
    RUN_END_DTTM TIMESTAMP(0),
    RUN_STTS_CD VARCHAR(10) NOT NULL
) PRIMARY INDEX(RUN_ID);

.LABEL LABEL_SKIP_CREATE_T_SUIVI_RUN

-- Check if T_SUIVI_TRMT table exists in TCH database
SELECT * FROM dbc.tables WHERE tablename='T_SUIVI_TRMT' AND databasename='TCH';

-- If the table exists, skip to the end
.IF ACTIVITYCOUNT>0 THEN .GOTO LABEL_SKIP_CREATE_T_SUIVI_TRMT;

-- Create T_SUIVI_TRMT table
CREATE TABLE TCH.T_SUIVI_TRMT (
    RUN_ID INTEGER NOT NULL,
    SCRPT_NAME VARCHAR(250) NOT NULL,
    EXEC_STRT_DTTM TIMESTAMP(0) NOT NULL,
    EXEC_END_DTTM TIMESTAMP(0),
    EXEC_STTS_CD VARCHAR(10) NOT NULL,
    EXEC_ID INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY
) PRIMARY INDEX (EXEC_ID);

.LABEL LABEL_SKIP_CREATE_T_SUIVI_TRMT

-- Termination
.IF ERRORCODE <> 0 THEN .QUIT 100;

.LOGOFF;
.EXIT;
