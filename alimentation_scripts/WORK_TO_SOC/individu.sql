LOGON localhost/dbc,dbc;


CREATE SET TABLE WRK.WRK_INDIVIDU (
    PART_ID INTEGER, 
    INDV_NAME VARCHAR(100) NOT NULL,
    INDV_FIRS_NAME  VARCHAR(100) NOT NULL,
    INDV_STTS_CD VARCHAR(10),
    TS_CREATION TIMESTAMP(0) NOT NULL,
    TS_MAJ TIMESTAMP(0) NOT NULL, 
    DT_NAISS DATE,
    VILLE_NAISS VARCHAR(100),
    PAYS_NAISS VARCHAR(100),
    NUM_SECU VARCHAR(15),
    EXEC_ID INTEGER
);

CREATE SET TABLE SOC.O_INDV(
    PART_ID 	    BIGINT NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    INDV_NAME	    VARCHAR(100) NOT NULL,
    INDV_FIRS_NAME	VARCHAR(100) NOT NULL,
    INDV_STTS_CD	VARCHAR(10) NOT NULL,
    CRTN_DTTM	    TIMESTAMP(0) NOT NULL,
    UPDT_DTTM	    TIMESTAMP(0) NOT NULL,
    BIRT_DT	        DATE,
    BIRT_CITY	    VARCHAR(100),
    BIRT_CNTR	    VARCHAR(100),
    SOCL_NUM	    VARCHAR(15),
    EXEC_ID	        INTEGER NOT NULL
) UNIQUE PRIMARY INDEX(PART_ID);
Écrire à Nesrine Serradj


MERGE INTO SOC.O_IND AS O_IND
USING WRK.WRK_INDIVIDU AS WRK_INDIVIDU
ON O_IND.PART_ID = WRK_INDIVIDU.PART_ID
WHEN MATCHED THEN
    UPDATE SET
        O_IND.INDV_NAME = WRK_INDIVIDU.NOM_INDIVIDU,
        O_IND.INDV_NAME = WRK_INDIVIDU.INDV_NAME,
        O_IND.INDV_FIRS_NAME = WRK_INDIVIDU.INDV_FIRS_NAME,
        O_IND.INDV_STTS_CD = WRK_INDIVIDU.INDV_STTS_CD,
        O_IND.CRTN_DTTM = WRK_INDIVIDU.TS_CREATION,
        O_IND.UPDT_DTTM = WRK_INDIVIDU.TS_MAJ,
        O_IND.BIRT_DT = WRK_INDIVIDU.DT_NAISS,
        O_IND.BIRT_CITY = WRK_INDIVIDU.VILLE_NAISS,
        O_IND.BIRT_CNTR = WRK_INDIVIDU.PAYS_NAISS,
        O_IND.SOCL_NUM = WRK_INDIVIDU.NUM_SECU,
        O_IND.EXEC_ID = 1


WHEN NOT MATCHED THEN
    INSERT (O_IND.INDV_NAME, O_IND.INDV_FIRS_NAME, O_IND.INDV_STTS_CD, O_IND.CRTN_DTTM, O_IND.UPDT_DTTM, O_IND.BIRT_DT, O_IND.BIRT_CITY, O_IND.BIRT_CNTR, O_IND.SOCL_NUM, O_IND.EXEC_ID)
    VALUES (WRK_INDIVIDU.NOM_INDIVIDU, WRK_INDIVIDU.INDV_NAME, WRK_INDIVIDU.INDV_FIRS_NAME, WRK_INDIVIDU.INDV_STTS_CD, WRK_INDIVIDU.TS_CREATION, WRK_INDIVIDU.TS_MAJ, WRK_INDIVIDU.DT_NAISS, WRK_INDIVIDU.VILLE_NAISS, WRK_INDIVIDU.PAYS_NAISS, WRK_INDIVIDU.NUM_SECU, 1);

.IF ERRORCODE <> 0 THEN .QUIT 100;

.LOGOFF;
.EXIT;


